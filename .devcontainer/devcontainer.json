{
  "name": "Frappe Dev Bench",

  // Image de dev : construite depuis .devcontainer/Dockerfile
  "build": {
    "dockerfile": "Dockerfile",
    "context": ".."
  },

  // Utilisateur défini dans le Dockerfile
  "remoteUser": "coder",

  // Dossier ouvert par défaut dans VS Code / code-server
  // Tu verras directement ~/frappe-bench une fois init-bench exécuté
  "workspaceFolder": "/home/coder",

  // Ports Frappe / dev
  "forwardPorts": [8000, 9000, 6787],

  // Extensions & settings VS Code
  "customizations": {
    "vscode": {
      "extensions": [
        "ms-python.python",
        "ms-vscode.live-server",
        "grapecity.gc-excelviewer",
        "mtxr.sqltools",
        "visualstudioexptteam.vscodeintellicode"
      ],
      "settings": {
        "terminal.integrated.profiles.linux": {
          "coder bash": {
            "path": "/bin/bash"
          }
        },
        "terminal.integrated.defaultProfile.linux": "coder bash",
        "debug.node.autoAttach": "disabled"
      }
    }
  },

  // (Optionnel) Montée de ta clé SSH locale dans le conteneur
  // Si ça pose problème dans Coder, tu peux supprimer entièrement ce bloc "mounts".
  "mounts": [
    "source=${localEnv:HOME}/.ssh,target=/home/coder/.ssh,type=bind,consistency=cached"
  ],

  // Au premier démarrage du conteneur :
  // 1) on démarre MariaDB + Redis
  // 2) on exécute ton script d'init qui crée ~/frappe-bench + development.localhost
  "postCreateCommand": "sudo service mariadb start && sudo service redis-server start && bash /workspaces/frappe-dev/development/init-bench.sh"
}
